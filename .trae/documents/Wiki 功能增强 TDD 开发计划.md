# Wiki åŠŸèƒ½å¢å¼º TDD å¼€å‘è®¡åˆ’

## ğŸ“‹ è®¡åˆ’æ¦‚è¿°

åŸºäºå·®è·åˆ†æï¼Œé‡‡ç”¨ **TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰** æ–¹å¼æŒç»­å®Œå–„ Wiki åŠŸèƒ½ï¼ŒæŒ‰ä¼˜å…ˆçº§åˆ† 4 ä¸ªé˜¶æ®µå®æ–½ã€‚

---

## ğŸ¯ TDD å¼€å‘åŸåˆ™

1. **çº¢-ç»¿-é‡æ„å¾ªç¯**
   - ğŸ”´ ç¼–å†™å¤±è´¥çš„æµ‹è¯•ï¼ˆRedï¼‰
   - ğŸŸ¢ ç¼–å†™æœ€ç®€å•çš„ä»£ç ä½¿æµ‹è¯•é€šè¿‡ï¼ˆGreenï¼‰
   - ğŸ”µ é‡æ„ä»£ç ï¼ˆRefactorï¼‰

2. **æµ‹è¯•å…ˆè¡Œ**
   - æ¯ä¸ªåŠŸèƒ½å¿…é¡»å…ˆæœ‰æµ‹è¯•
   - æµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
   - å…³é”®è·¯å¾„ 100% è¦†ç›–

3. **å°æ­¥å¿«è·‘**
   - æ¯ä¸ªä»»åŠ¡ç‹¬ç«‹æäº¤
   - é¢‘ç¹è¿è¡Œæµ‹è¯•å¥—ä»¶
   - åŠæ—¶é‡æ„ä¿æŒä»£ç è´¨é‡

---

## ğŸ“… å¼€å‘é˜¶æ®µè§„åˆ’

### Phase 1: P0 æ ¸å¿ƒåŠŸèƒ½ï¼ˆç¬¬ 1-2 å‘¨ï¼‰

#### 1.1 Wiki å…±äº«æœºåˆ¶æµ‹è¯•ä¸å®Œå–„

**å½“å‰çŠ¶æ€**: æ ¸å¿ƒå®ç°å·²å®Œæˆï¼Œç¼ºå°‘å®Œæ•´æµ‹è¯•

**TDD ä»»åŠ¡æ¸…å•**:

| åºå· | ä»»åŠ¡ | æµ‹è¯•æ–‡ä»¶ | ç›®æ ‡ |
|------|------|---------|------|
| 1.1.1 | é…ç½®éªŒè¯æµ‹è¯• | `wiki-sharing-config.test.ts` | éªŒè¯é…ç½®é»˜è®¤å€¼ã€éªŒè¯é€»è¾‘ |
| 1.1.2 | å…±äº«åŠŸèƒ½å•å…ƒæµ‹è¯• | `wiki-sharing-service.test.ts` | share(), prepareContent(), createManifest() |
| 1.1.3 | Git é›†æˆæµ‹è¯• | `wiki-sharing-git.test.ts` | commitToGit(), pushToRemote(), pullFromRemote() |
| 1.1.4 | å†²çªæ£€æµ‹æµ‹è¯• | `wiki-sharing-conflict.test.ts` | detectConflicts(), createConflictFromFile() |
| 1.1.5 | å†²çªè§£å†³æµ‹è¯• | `wiki-sync-resolver.test.ts` | resolveConflict(), applyResolution() |
| 1.1.6 | é›†æˆæµ‹è¯• | `wiki-sharing-integration.test.ts` | ç«¯åˆ°ç«¯å…±äº«æµç¨‹ |
| 1.1.7 | è¾¹ç•Œæƒ…å†µæµ‹è¯• | `wiki-sharing-edge.test.ts` | ç©ºæ–‡æ¡£ã€å¤§æ–‡ä»¶ã€ç‰¹æ®Šå­—ç¬¦ |

**éªŒæ”¶æ ‡å‡†**:
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 85%
- [ ] é›†æˆæµ‹è¯•è¦†ç›–ä¸»è¦ä½¿ç”¨åœºæ™¯
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç é™æ€æ£€æŸ¥æ— é”™è¯¯

#### 1.2 å¼•ç”¨å…³ç³»å›¾è°±å¯è§†åŒ–æµ‹è¯•ä¸å®Œå–„

**å½“å‰çŠ¶æ€**: åŸºç¡€å®ç°å®Œæˆï¼Œç¼ºå°‘æµ‹è¯•å’Œéƒ¨åˆ†é«˜çº§åŠŸèƒ½

**TDD ä»»åŠ¡æ¸…å•**:

| åºå· | ä»»åŠ¡ | æµ‹è¯•æ–‡ä»¶ | ç›®æ ‡ |
|------|------|---------|------|
| 1.2.1 | ä¾èµ–å›¾ç”Ÿæˆæµ‹è¯• | `dependency-graph.test.ts` | æ¨¡å—/æ–‡ä»¶ä¾èµ–å›¾ç”Ÿæˆ |
| 1.2.2 | è°ƒç”¨å›¾ç”Ÿæˆæµ‹è¯• | `call-graph.test.ts` | å‡½æ•°è°ƒç”¨å…³ç³»å›¾ |
| 1.2.3 | ç»§æ‰¿å›¾ç”Ÿæˆæµ‹è¯• | `inheritance-graph.test.ts` | ç±»ç»§æ‰¿/æ¥å£å®ç°å›¾ |
| 1.2.4 | å¾ªç¯ä¾èµ–æ£€æµ‹æµ‹è¯• | `cycle-detection.test.ts` | detectCycles() å‡†ç¡®æ€§ |
| 1.2.5 | Mermaid å¯¼å‡ºæµ‹è¯• | `mermaid-export.test.ts` | è¯­æ³•æ­£ç¡®æ€§ã€æ¸²æŸ“æµ‹è¯• |
| 1.2.6 | SVG å¯¼å‡ºæµ‹è¯• | `svg-export.test.ts` | æ ¼å¼æ­£ç¡®æ€§ã€èŠ‚ç‚¹ä½ç½® |
| 1.2.7 | å›¾è°±è¿‡æ»¤æµ‹è¯• | `graph-filter.test.ts` | filterGraph() å„ç§æ¡ä»¶ |
| 1.2.8 | æ€§èƒ½æµ‹è¯• | `graph-performance.test.ts` | å¤§é¡¹ç›®å›¾è°±ç”Ÿæˆæ€§èƒ½ |

**éªŒæ”¶æ ‡å‡†**:
- [ ] å„ç±»å›¾è°±ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
- [ ] å¾ªç¯ä¾èµ–æ£€æµ‹å‡†ç¡®ç‡ 100%
- [ ] Mermaid è¯­æ³• 100% å¯æ¸²æŸ“
- [ ] æ”¯æŒ 1000+ èŠ‚ç‚¹çš„å›¾è°±ç”Ÿæˆ

---

### Phase 2: P1 åä½œåŠŸèƒ½ï¼ˆç¬¬ 3-4 å‘¨ï¼‰

#### 2.1 å›¢é˜Ÿåä½œåŠŸèƒ½å®Œå–„

**å½“å‰çŠ¶æ€**: æ¡†æ¶å·²å®šä¹‰ï¼Œéœ€å®Œå–„å®ç°å’Œæµ‹è¯•

**TDD ä»»åŠ¡æ¸…å•**:

| åºå· | ä»»åŠ¡ | æµ‹è¯•æ–‡ä»¶ | ç›®æ ‡ |
|------|------|---------|------|
| 2.1.1 | ç”¨æˆ·ç®¡ç†æµ‹è¯• | `wiki-collaboration-service.test.ts` | add/remove/update contributor |
| 2.1.2 | æƒé™æ£€æŸ¥æµ‹è¯• | `wiki-permission.test.ts` | checkPermission() å„ç§åœºæ™¯ |
| 2.1.3 | è§’è‰²æƒé™æµ‹è¯• | `wiki-role-permission.test.ts` | admin/editor/viewer æƒé™éªŒè¯ |
| 2.1.4 | é¡µé¢é”æµ‹è¯• | `wiki-lock.test.ts` | lockPage(), unlockPage(), è¶…æ—¶é‡Šæ”¾ |
| 2.1.5 | å¹¶å‘ç¼–è¾‘æµ‹è¯• | `wiki-concurrent-edit.test.ts` | å¤šç”¨æˆ·å¹¶å‘åœºæ™¯ |
| 2.1.6 | ç¼–è¾‘ä¼šè¯æµ‹è¯• | `wiki-edit-session.test.ts` | createSession(), ä¼šè¯ç”Ÿå‘½å‘¨æœŸ |
| 2.1.7 | é›†æˆæµ‹è¯• | `wiki-collaboration-integration.test.ts` | å®Œæ•´åä½œæµç¨‹ |

#### 2.2 ADR åŠŸèƒ½å®Œå–„

**å½“å‰çŠ¶æ€**: CRUD å’ŒçŠ¶æ€æµè½¬å·²å®ç°ï¼Œè‡ªåŠ¨æå–å¾…å®Œå–„

**TDD ä»»åŠ¡æ¸…å•**:

| åºå· | ä»»åŠ¡ | æµ‹è¯•æ–‡ä»¶ | ç›®æ ‡ |
|------|------|---------|------|
| 2.2.1 | ADR CRUD æµ‹è¯• | `adr-service-crud.test.ts` | create, update, get, list, delete |
| 2.2.2 | ADR çŠ¶æ€æµè½¬æµ‹è¯• | `adr-service-state.test.ts` | proposeâ†’acceptâ†’deprecate |
| 2.2.3 | ä»£ç æ³¨é‡Šæå–æµ‹è¯• | `adr-extractor-code.test.ts` | @decision, @why æ ‡ç­¾æå– |
| 2.2.4 | æäº¤ä¿¡æ¯æå–æµ‹è¯• | `adr-extractor-commit.test.ts` | conventional commits è§£æ |
| 2.2.5 | æ–‡æ¡£æå–æµ‹è¯• | `adr-extractor-docs.test.ts` | RFC, è®¾è®¡æ–‡æ¡£è§£æ |
| 2.2.6 | æ¨¡æ¿ç³»ç»Ÿæµ‹è¯• | `adr-templates.test.ts` | fillTemplate(), å˜é‡æ›¿æ¢ |
| 2.2.7 | å…³è”ç®¡ç†æµ‹è¯• | `adr-relations.test.ts` | linkToPage(), linkToCode() |

---

### Phase 3: P2 ä½“éªŒå¢å¼ºï¼ˆç¬¬ 5-6 å‘¨ï¼‰

#### 3.1 Wiki ç¼–è¾‘å™¨å¢å¼º

**TDD ä»»åŠ¡æ¸…å•**:

| åºå· | ä»»åŠ¡ | æµ‹è¯•æ–‡ä»¶ | ç›®æ ‡ |
|------|------|---------|------|
| 3.1.1 | ç¼–è¾‘ä¼šè¯æµ‹è¯• | `wiki-editor-session.test.ts` | create, update, end session |
| 3.1.2 | è‡ªåŠ¨ä¿å­˜æµ‹è¯• | `wiki-editor-autosave.test.ts` | enableAutoSave(), å®šæ—¶ä¿å­˜ |
| 3.1.3 | è‰ç¨¿ç®¡ç†æµ‹è¯• | `wiki-editor-drafts.test.ts` | saveDraft(), restoreDraft() |
| 3.1.4 | é¢„è§ˆæ¸²æŸ“æµ‹è¯• | `wiki-preview.test.ts` | renderPreview(), Markdown æ¸²æŸ“ |
| 3.1.5 | æ¨¡æ¿åº”ç”¨æµ‹è¯• | `wiki-templates-apply.test.ts` | applyTemplate(), å˜é‡å¡«å…… |
| 3.1.6 | è‡ªå®šä¹‰æ¨¡æ¿æµ‹è¯• | `wiki-templates-custom.test.ts` | createTemplate(), validate |

#### 3.2 æ¶æ„æ–‡æ¡£å¯è§†åŒ–

**TDD ä»»åŠ¡æ¸…å•**:

| åºå· | ä»»åŠ¡ | æµ‹è¯•æ–‡ä»¶ | ç›®æ ‡ |
|------|------|---------|------|
| 3.2.1 | åˆ†å±‚æ¶æ„å›¾æµ‹è¯• | `architecture-layered.test.ts` | generateLayeredDiagram() |
| 3.2.2 | ç»„ä»¶æ¶æ„å›¾æµ‹è¯• | `architecture-component.test.ts` | generateComponentDiagram() |
| 3.2.3 | éƒ¨ç½²æ¶æ„å›¾æµ‹è¯• | `architecture-deployment.test.ts` | generateDeploymentDiagram() |
| 3.2.4 | å›¾è¡¨å¯¼å‡ºæµ‹è¯• | `diagram-exporter.test.ts` | Mermaid, SVG, PNG å¯¼å‡º |
| 3.2.5 | å›¾è¡¨æ ·å¼æµ‹è¯• | `diagram-styles.test.ts` | é¢œè‰²ã€å¸ƒå±€ã€ä¸»é¢˜ |

---

### Phase 4: P3 é«˜çº§åŠŸèƒ½ï¼ˆç¬¬ 7-8 å‘¨ï¼‰

#### 4.1 çŸ¥è¯†å›¾è°±æ„å»º

**TDD ä»»åŠ¡æ¸…å•**:

| åºå· | ä»»åŠ¡ | æµ‹è¯•æ–‡ä»¶ | ç›®æ ‡ |
|------|------|---------|------|
| 4.1.1 | æ¦‚å¿µèŠ‚ç‚¹æå–æµ‹è¯• | `node-extractor-concept.test.ts` | extractConcepts() å‡†ç¡®ç‡ |
| 4.1.2 | API èŠ‚ç‚¹æå–æµ‹è¯• | `node-extractor-api.test.ts` | extractAPIs() å®Œæ•´æ€§ |
| 4.1.3 | æ¨¡å¼èŠ‚ç‚¹æå–æµ‹è¯• | `node-extractor-pattern.test.ts` | extractPatterns() è¯†åˆ«ç‡ |
| 4.1.4 | è¾¹æ„å»ºæµ‹è¯• | `edge-builder.test.ts` | buildEdges(), å…³ç³»å‡†ç¡®æ€§ |
| 4.1.5 | èšç±»åˆ†ææµ‹è¯• | `edge-builder-cluster.test.ts` | clusterNodes(), ç¤¾åŒºå‘ç° |
| 4.1.6 | ç›¸å…³èŠ‚ç‚¹æŸ¥è¯¢æµ‹è¯• | `recommendation-related.test.ts` | findRelated(), ç›¸å…³æ€§è¯„åˆ† |
| 4.1.7 | å­¦ä¹ è·¯å¾„æµ‹è¯• | `recommendation-path.test.ts` | getLearningPath(), è·¯å¾„åˆç†æ€§ |
| 4.1.8 | æ™ºèƒ½æ¨èæµ‹è¯• | `recommendation-smart.test.ts` | recommend(), æ¨èè´¨é‡ |

#### 4.2 å˜æ›´å½±å“åˆ†æå¢å¼º

**TDD ä»»åŠ¡æ¸…å•**:

| åºå· | ä»»åŠ¡ | æµ‹è¯•æ–‡ä»¶ | ç›®æ ‡ |
|------|------|---------|------|
| 4.2.1 | ç›´æ¥å½±å“åˆ†ææµ‹è¯• | `change-impact-direct.test.ts` | analyzeDirectImpact() |
| 4.2.2 | é—´æ¥å½±å“åˆ†ææµ‹è¯• | `change-impact-indirect.test.ts` | analyzeIndirectImpact() |
| 4.2.3 | å½±å“é“¾è·¯è¿½è¸ªæµ‹è¯• | `change-impact-chain.test.ts` | traceImpactChain(), å®Œæ•´æ€§ |
| 4.2.4 | é£é™©è¯„åˆ†æµ‹è¯• | `risk-assessment-score.test.ts` | calculateRiskScore() |
| 4.2.5 | é£é™©å› ç´ è¯†åˆ«æµ‹è¯• | `risk-assessment-factors.test.ts` | identifyRiskFactors() |
| 4.2.6 | ç¼“è§£å»ºè®®æµ‹è¯• | `risk-assessment-mitigation.test.ts` | generateMitigation() |
| 4.2.7 | æ–‡æ¡£æ›´æ–°å»ºè®®æµ‹è¯• | `suggestion-docs.test.ts` | suggestDocUpdates() |
| 4.2.8 | æµ‹è¯•è¿è¡Œå»ºè®®æµ‹è¯• | `suggestion-tests.test.ts` | suggestTestRuns() |
| 4.2.9 | é€šçŸ¥å»ºè®®æµ‹è¯• | `suggestion-notify.test.ts` | suggestNotifications() |

---

## ğŸ”„ TDD å¼€å‘æµç¨‹

### æ¯ä¸ªä»»åŠ¡çš„å¼€å‘æµç¨‹

```
1. ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼ˆRedï¼‰
   â””â”€â”€ åˆ›å»ºæµ‹è¯•æ–‡ä»¶
   â””â”€â”€ ç¼–å†™å¤±è´¥æµ‹è¯•
   â””â”€â”€ è¿è¡Œæµ‹è¯•ç¡®è®¤å¤±è´¥

2. å®ç°åŠŸèƒ½ä»£ç ï¼ˆGreenï¼‰
   â””â”€â”€ ç¼–å†™æœ€å°‘ä»£ç ä½¿æµ‹è¯•é€šè¿‡
   â””â”€â”€ è¿è¡Œæµ‹è¯•ç¡®è®¤é€šè¿‡
   â””â”€â”€ å¦‚æœ‰å…¶ä»–å¤±è´¥ï¼Œä¿®å¤

3. é‡æ„ä¼˜åŒ–ï¼ˆRefactorï¼‰
   â””â”€â”€ æ”¹è¿›ä»£ç ç»“æ„
   â””â”€â”€ æ¶ˆé™¤é‡å¤
   â””â”€â”€ è¿è¡Œæµ‹è¯•ç¡®ä¿ä»é€šè¿‡

4. æäº¤ä»£ç 
   â””â”€â”€ æäº¤ä¿¡æ¯: "feat(æ¨¡å—): åŠŸèƒ½æè¿°"
   â””â”€â”€ åŒ…å«æµ‹è¯•æ–‡ä»¶
```

### æ¯æ—¥å¼€å‘èŠ‚å¥

| æ—¶é—´ | æ´»åŠ¨ | äº§å‡º |
|------|------|------|
| ä¸Šåˆ | ç¼–å†™æµ‹è¯• | æ–°æµ‹è¯•æ–‡ä»¶ |
| ä¸­åˆå‰ | å®ç°åŠŸèƒ½ | é€šè¿‡æµ‹è¯•çš„ä»£ç  |
| ä¸‹åˆ | é‡æ„ä¼˜åŒ– | é«˜è´¨é‡ä»£ç  |
| ä¸‹ç­å‰ | è¿è¡Œå…¨é‡æµ‹è¯• | æµ‹è¯•æŠ¥å‘Š |

---

## ğŸ“Š æµ‹è¯•ç­–ç•¥

### æµ‹è¯•é‡‘å­—å¡”

```
       /\
      /  \  E2E æµ‹è¯• (10%)
     /----\
    /      \  é›†æˆæµ‹è¯• (30%)
   /--------\
  /          \  å•å…ƒæµ‹è¯• (60%)
 /------------\
```

### æµ‹è¯•è¦†ç›–ç›®æ ‡

| å±‚çº§ | ç›®æ ‡è¦†ç›–ç‡ | æ£€æŸ¥å·¥å…· |
|------|-----------|---------|
| å•å…ƒæµ‹è¯• | â‰¥ 80% | jest --coverage |
| é›†æˆæµ‹è¯• | æ ¸å¿ƒæµç¨‹ | æ‰‹åŠ¨éªŒè¯ |
| E2E æµ‹è¯• | å…³é”®è·¯å¾„ | è‡ªåŠ¨åŒ–è„šæœ¬ |

---

## ğŸ“ æ–‡æ¡£æ›´æ–°è®¡åˆ’

æ¯ä¸ª Phase å®Œæˆåæ›´æ–°:

1. **CHANGELOG.md** - è®°å½•åŠŸèƒ½å˜æ›´
2. **API æ–‡æ¡£** - æ›´æ–° JSDoc
3. **ä½¿ç”¨ç¤ºä¾‹** - æ·»åŠ ç¤ºä¾‹ä»£ç 
4. **å¼€å‘æ–‡æ¡£** - æ›´æ–°æ¶æ„å›¾

---

## âœ… éªŒæ”¶æ£€æŸ¥ç‚¹

### Phase 1 éªŒæ”¶
- [ ] Wiki å…±äº«åŠŸèƒ½ 100% æµ‹è¯•è¦†ç›–
- [ ] å›¾è°±å¯è§†åŒ–åŠŸèƒ½ 100% æµ‹è¯•è¦†ç›–
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•è¾¾æ ‡

### Phase 2 éªŒæ”¶
- [ ] åä½œåŠŸèƒ½å®Œæ•´å®ç°
- [ ] ADR è‡ªåŠ¨æå–å‡†ç¡®ç‡ â‰¥ 70%
- [ ] å¹¶å‘æµ‹è¯•é€šè¿‡

### Phase 3 éªŒæ”¶
- [ ] ç¼–è¾‘å™¨ä½“éªŒä¼˜åŒ–å®Œæˆ
- [ ] æ¶æ„å›¾å¯¼å‡ºåŠŸèƒ½å®Œå–„
- [ ] UI/UX æµ‹è¯•é€šè¿‡

### Phase 4 éªŒæ”¶
- [ ] çŸ¥è¯†å›¾è°±æ„å»ºå®Œæˆ
- [ ] å˜æ›´å½±å“åˆ†æå‡†ç¡®ç‡ â‰¥ 80%
- [ ] æ•´ä½“æµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%

---

## ğŸš€ å¼€å§‹ç¬¬ä¸€ä¸ªä»»åŠ¡

å»ºè®®ä» **Phase 1.1.1 - Wiki å…±äº«é…ç½®éªŒè¯æµ‹è¯•** å¼€å§‹:

1. åˆ›å»ºæµ‹è¯•æ–‡ä»¶: `tests/wiki/sharing/wiki-sharing-config.test.ts`
2. ç¼–å†™é…ç½®é»˜è®¤å€¼æµ‹è¯•
3. ç¼–å†™é…ç½®éªŒè¯é€»è¾‘æµ‹è¯•
4. è¿è¡Œæµ‹è¯•ï¼ˆåº”å¤±è´¥ï¼‰
5. å®ç°é…ç½®éªŒè¯ä»£ç 
6. è¿è¡Œæµ‹è¯•ï¼ˆåº”é€šè¿‡ï¼‰
7. é‡æ„ä¼˜åŒ–
8. æäº¤ä»£ç 

æ˜¯å¦å¼€å§‹æ‰§è¡Œè¿™ä¸ªè®¡åˆ’ï¼Ÿ